#!/usr/bin/python3
import socket
import sys
#puertos comunes
common_ports={21:'ftp',22:'ssh',23:'telnet',25:'smtp',53:'dns',135:'NetBios',139:'NetBios',110:'POP3',143:'imap',389:'LDAP',8080:'proxy web',80:'http', 443:'secure http', 9418:'git'}

def port_scanner(target, start, end, time=1):
	#tiempo de espera predeterminado en segundos
	socket.setdefaulttimeout(time)
	for item in range(start,end):
		# creamos un socket (IPv4, TCP)
		mi_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		try:
			mi_socket.connect((target, item))
			try:
				print("open port --> ", item,common_ports[item]); mi_socket.close();
			except KeyError:
				print("open port --> ", item); mi_socket.close();
		except socket.error:
			mi_socket.close()
port_scanner("127.0.0.1", 1, 1024);